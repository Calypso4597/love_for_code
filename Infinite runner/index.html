<!DOCTYPE html>
<html>
<head>
<style>
canvas {
    background-color: #000000;
}
</style>
</head>
<body onload="startGame()">
<script>

var player;
var pillars = [];
 var spriteWidth = 956; 
 var spriteHeight = 189; 

 var rows = 1; 
 var cols = 8; 
  
 var swidth = spriteWidth/cols; 
 
 var sheight = spriteHeight/rows; 
 
 var curFrame = 0; 
 
 var frameCount = 8; 
 
 var srcX=0; 
 var srcY=0; 

function startGame() {
    player = new component(50, 50, "sprite.png", 20, 430, "image");
    main.start();
}

var main = {
    canvas : document.createElement("canvas"),
    start : function() {
        this.canvas.width = 800;
        this.canvas.height = 600;
        this.context = this.canvas.getContext("2d");
        document.body.insertBefore(this.canvas, document.body.childNodes[0]);
        this.frame = 0;
        this.interval = setInterval(updateMain, 12);
        },
    clear : function() {
        this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
    }    
}

function updateFrame(){
 curFrame = ++curFrame % frameCount;
 srcX = curFrame * swidth;
    ct=main.context;
    ct.clearRect(20,430,swidth,sheight);
}

function component(width, height, color, x, y,type) {
     this.type = type;
    if (type == "image") {
        this.image = new Image();
        this.image.src = color;
    } 
    this.width = width;
    this.height = height;   
    this.x = x;
    this.y = y;    
    this.update = function() {
        ctx = main.context;
        if (type == "image") {
            updateFrame();
            ctx.drawImage(this.image,srcX,srcY,swidth,sheight,this.x,this.y,swidth,sheight);
            }
            
            else {
            ctx.fillStyle = color;
            ctx.fillRect(this.x, this.y, this.width, this.height);
            }
        }
}

function moon(){
            c=main.context;
            c.beginPath();
            c.fillStyle = "white";
            c.arc(400, 70, 20, 0, Math.PI * 2);
            c.fill();
        }

function updateMain() {
    var x, y;
    var pw=60;
    var ph=150 + Math.random()*120;
    main.clear();
    main.frame += 1;
    if (main.frame == 1 || everyinterval(200)) {
        x = main.canvas.width;
        y = main.canvas.height-ph;
        pillars.push(new component(pw, ph, "white", x, y));
    }
    for (i = 0; i < pillars.length; i += 1) {
        pillars[i].x += -2;
        pillars[i].update();
    }    
    player.update();
    moon();
}

function everyinterval(n) {
       if ((main.frame / n) % 1 == 0) {return true;}
    return false;
}
</script>
</body>
</html>
